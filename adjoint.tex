\documentclass[10pt]{amsart}

\title{Computing Adjoint $L$-functions}
\author{David Roe}
\address{Department of Mathematics, University of Pittsburgh, 301 Thackeray Hall, Pittsburgh, PA , United States, 15260.}
\email{roed.math@gmail.com}
\author{Ander Steele}
\address{Department of Mathematics, University of California Santa Cruz, 1156 High Street, Santa Cruz, CA, United States, 95060}
\email{gasteele@ucsc.edu}

%\subjclass[2010]{}
%\keywords{}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsrefs}
% Fonts
\usepackage{mathrsfs}
% Enumitem
\usepackage{enumitem}
% Hyperrefs
\usepackage{hyperref}

%\usepackage{tikz}
%\usetikzlibrary{shapes,arrows,calc,matrix}
%\usepackage{tikz-cd}

%%%%% for spacing
\usepackage{lipsum}
\usepackage{setspace}

%%%%%%%%%%%%%%% THEOREM STYLES %%%%%%%%%%%%%%%
\theoremstyle{plain}
      \newtheorem{theorem}{Theorem}[section]
      \newtheorem*{theorem*}{Theorem}
      \newtheorem{proposition}[theorem]{Proposition}
      \newtheorem{lemma}[theorem]{Lemma}
      \newtheorem{corollary}[theorem]{Corollary}

      \theoremstyle{definition}
      \newtheorem{definition}[theorem]{Definition}

      %\theoremstyle{remark}
      \newtheorem{remark}[theorem]{Remark}
      \newtheorem{example}[theorem]{Example}
      
      \newtheorem{conjecture}[theorem]{Conjecture}
%%%%%%%%%%%%%%% RINGS AND GROUPS %%%%%%%%%%%%%%%
\newcommand{\ZZ}{{\mathbb{Z}}}
\newcommand{\NN}{{\mathbb{N}}}
\newcommand{\CC}{{\mathbb{C}}}
\newcommand{\QQ}{{\mathbb{Q}}}
\newcommand{\RR}{{\mathbb{R}}}
\newcommand{\OK}{\mathcal{O}_K}
\newcommand{\cH}{\mathcal{H}}
%%%%%%%%%%%%%%% NAMED OPERATORS %%%%%%%%%%%%%%%
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\ord}{ord}

\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\PGL}{PGL}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\Symb}{Symb}
\DeclareMathOperator{\BSymb}{BSymb}
\DeclareMathOperator{\Hh}{H}
\DeclareMathOperator{\cor}{cor}
\DeclareMathOperator{\ad}{ad}



%%%%%%%%%%%% BEGIN DOCUMENT %%%%%%%%%%%
\usepackage{todonotes}

\begin{document}
\maketitle

\section{Introduction}

\section{Review}

Let $E$ be a complete, discrete valued field.  \todo{think about what works in characteristic $p$}

\section{Cohomology of Modular Curves} \label{sec:mod_curve_cohom}
% Reference appendix to Hida's Elementary Theory of L-functions and Eisenstein Series
%The theory of modular symbols allows us to efficiently compute with spaces of modular forms. We briefly recall 

[Short summary: We compute modular forms through modular symbols. Modular symbols are $H^1_c$, $H^1_p$ is a natural quotient., and our pairings factor through this projection. Thus, all our computations reduce to group cohomology]



Let $\Gamma$ be a congruence subgroup---in our examples, we will take $\Gamma_0(N)$. Denote by $\Delta_0$ the degree-$0$ divisors on $\mathbb{P}^1(\QQ)$, equipped with the left action of $\Gamma$ by fractional-linear-transformations. Let $M$ be any right $\ZZ[\Gamma]$-module. The space of $M$-valued modular symbols for $\Gamma$ is defined as
\begin{equation*}
	\Symb_\Gamma(M) := \Hom_{\ZZ[\Gamma]}(\Delta_0, M).
\end{equation*}

\begin{proposition}[Ash-Stevens]
Suppose $\Gamma$ acts invertibly on $\cH$, or $6$ acts invertibly on $M$. Then $H^1_c(\Gamma,M)$ is [canonically and functorially?] isomorphic to $\Symb_\Gamma(M)$.
%and we have an exact sequence:
%\begin{equation*}
%\BSymb_\Gamma(M)\longrightarrow \Symb_\Gamma(M)\longrightarrow H^1_p(\Gamma, M)\longrightarrow 0
%\end{equation*}
\end{proposition}

The compactly supported cohomology of the group $\Gamma$ is defined as \todo{do we need this?}
[Need to distinguish the cohomology of the modular curve and group cohomology, and make precise comparisons... eg. $H^*(\Gamma, M) = H^*(Y, \widetilde{M})$]

%the the compactly supported cohomology of the open modular curve $\Gamma\cH$, with coefficients in the local system blah blah blah.


We have a natural map $H^1_c(\Gamma, M)\longrightarrow H^1(\Gamma,M)$, and thus a natural map from $\Symb_\Gamma(M)\longrightarrow H^1(\Gamma,M)$. Concretely, a modular symbol $\Phi\in \Symb_\Gamma(M)$ is mapped to the cohomology class of the cocycle $\sigma_\Phi$ defined by
\begin{align*}
\sigma_{\Phi}(\alpha, \beta) &= \Phi(\{\alpha \cdot \infty, \beta \cdot \infty\}).% \\
%\sigma_{\Psi}(\alpha, \beta) &= \Psi(\{\alpha \cdot \infty, \beta \cdot \infty\}).
\end{align*}
\begin{definition}
The parabolic cohomology $H^1_p(\Gamma,M)$ is defined to be the image of the natural map $H^1_c(\Gamma,M)\longrightarrow H^1_p(\Gamma,M)$.
\end{definition}
[The kernel of the map $\Symb_\Gamma(M)\longrightarrow H^1_p(\Gamma,M)$ is the subspace of boundary symbols, which we don't need to say anything about]

The connection with modular forms is described by the Eichler-Shimura Isomorphism. For each integer $k\geq 0$, define $V_k:=\Sym^k(\CC^2)\cong \CC[X,Y]_k$. $V_k$ is equipped with a right action of $\Gamma$ by $P(X,Y)|\gamma =P((X,Y)|\gamma^{-1})=P(dX-cY,-bX+aY)$ %see 3.4 of Pollack-Stevens
\begin{theorem}[Eichler-Shimura]
There exists a Hecke-equivariant isomorphism
\begin{equation*}
	H^1_p(\Gamma, V_k) \cong S_{k+2}(\Gamma)\oplus \overline{S_{k+2}(\Gamma)}
\end{equation*}
\end{theorem}

[Replacing the coefficient module $V_k$ by $p$-adic distributions, one obtains an overconvergent Eichler-Shimura isomorphism comparing overconvergent modular symbols with overconvergent modular forms. \cite{Andreatta, Iovita, Stevens}. We probably don't need to say this, but it might motivate the our constructions]

\section{Existing Pairings on Modular Symbols} \label{sec:existing_pairings}
% Reference discussions of pairings in Bellaiche and Kim's thesis
% Relate to Petersson inner product
The Petersson inner product is a natural Hermitian inner product on $S_{k+2}(\Gamma,\CC)$ defined by:
\begin{equation*}
	(f,g) := \int_{\cH/\Gamma} f(z) \overline{g(z)} y^{k} dx dy
\end{equation*}

[Here we introduce the Rankin product and adjoint $L$-function, and state the relationship between these and Petersson inner product. Roughly $(f,f)=L(\ad f,k+1)$]

The pairing on $V_k$ [where to put this] and the cup product induce a pairing on $H^1_c(V_k)$:
\begin{equation*}
	H^1_c(V_k)\times H^1_c(V_k) \longrightarrow H^2_c(V_k\otimes V_k)\longrightarrow H^2_c(\CC)\cong \CC
\end{equation*}

\begin{proposition}[III.2.6 of Bella\"iche]
\begin{equation*}
	(\phi_f,\phi_g ) = (2i)^{k-1}[(f,g) + (-1)^{k+1} (g,f)]
\end{equation*}
\end{proposition}


[Bella\"iche, section III.2.7]
Hecke operators: Suppose now that $\Gamma_1(N)\subseteq \Gamma \subseteq \Gamma_0(N)$. Let 
\begin{equation}
	W_N = \begin{pmatrix} 0 & -1 \\ N & 0\end{pmatrix}
\end{equation}
which normalizes $\Gamma_0(N)$ and (after some work) $\Gamma$. See Lemma III.2.4.

The ``corrected" scalar product:
\begin{equation*}
	[f,g] : =(f,g|W)
\end{equation*}

\begin{lemma}[III.2.26]
The Hecke operators $T_\ell$ ($\ell\nmid N$, $U_q$ , and $\langle a \rangle$ are self-adjoint with respect to the corrected scalar product:
\begin{equation*}
	[f|T,g]=[f,g|T].
\end{equation*}	
\end{lemma}





\section{Pairings on Coefficient Modules} \label{sec:coeff_pairing}

We have assumed given a $\Gamma$-equivariant pairing $\langle~,~ \rangle : M \times M \longrightarrow E$ (or another trial $\Gamma$ representation). We explicitly write down the pairing in the cases of interest and check that the necessary equivariance is satisfied. 

\subsection{$\Sym^k(E^2)$}

We identify $\Sym^k(E^2)$ with $E[X,Y]_k$, and endow it with left action of $\GL_2(\QQ)$ by $\gamma \cdot P(X,Y) = P((X,Y)\gamma)=P(aX+cY,bX+dY).$ 
\begin{definition}
Define a bilinear pairing on $\Sym^k(E^2)$ by
\begin{equation*}
	\langle X^iY^{k-i}, X^j Y^{k-j} \rangle = \begin{cases} (-1)^i {k \choose i} & \text{ if } i+j=k\\
												0	& \text{ otherwise} \end{cases}
\end{equation*}
and extending via linearity.
\end{definition}


\begin{lemma}
For all $\gamma\in \GL_2(\QQ)$, $P,Q\in\Sym^k(E^2)$, we have $\langle \gamma\cdot P,\gamma \cdot Q\rangle = \det(\gamma)^k \langle P,Q\rangle$.
\end{lemma}
\begin{proof}
This can be seen via an ugly computation. (There should be an easy way to see this in terms of the wedge product).
\end{proof}

For the purposes of Hecke-equivariance, we define a twisted pairing using the Atkin-Lehner involution $W_N = \begin{pmatrix} 0 & -1 \\ N & 0 \end{pmatrix}$.
\begin{definition}
The twisted pairing on $\Sym^k(E^2)$ is defined by
\begin{equation}
	\langle P, Q\rangle^t := \langle P, W_N \cdot Q\rangle.
\end{equation}
\end{definition}
More explicitly,
\begin{equation*}
	\langle X^iY^{k-i}, X^j Y^{k-j} \rangle_N^t = \langle X^i Y^{k-i}, (-Y)^j(NX)^{k-j}\rangle= \begin{cases} (-1)^k N^i {k \choose i} & \text{ if } i=j\\
												0	& \text{ otherwise} \end{cases}
\end{equation*}

\section{Reducing to Level 1} \label{sec:level_one}

Suppose that $\Phi, \Psi \in \Symb_{\Gamma_0(N)}(M)$ are overconvergent modular symbols.  As in Section \ref{sec:mod_curve_cohom}, we associate to them homogeneous $1$-cocycles in $Z^1(\Gamma_0(N), M)$ by the following formulas:
\begin{align*}
\sigma_{\Phi}(\alpha) &= \Phi(\{\infty, \alpha \cdot \infty\}) \\
\sigma_{\Psi}(\beta) &= \Psi(\{\alpha \cdot \infty, \alpha \cdot \beta \cdot \infty\}).
\end{align*}
%f(\alpha) \otimes g(\alpha \cdot \beta)
The pairing $M \times M \to E$ from Section \ref{sec:coeff_pairing} then induces a natural cup product pairing $\Hh^1_P(\Gamma_0(N), M) \times \Hh^1_P(\Gamma_0(N), M) \to \Hh^2_P(\Gamma_0(N), E)$.  In order to compute this pairing, we need to give an explicit isomorphism $\omega : \Hh^2_P(\Gamma_0(N), E) \to E$, which we do in two steps.

First, corestriction provides an isomorphism $\cor : \Hh^2(\Gamma_0(N), E) \to \Hh^2(\SL_2(\ZZ), E)$, given by multiplication by $[\SL_2(\ZZ) : \Gamma_0(N)]$, \todo{need isomorphism on parabolic cohomology, not normal cohomology} so we need only compute an isomorphism $\Hh^2_P(\SL_2(\ZZ), E) \to E$.  Using Theorem \ref{thm:H2E}, we have
\[
\Hh^2_P(\SL_2(\ZZ), E) \cong Z^2(\SL_2(\ZZ), E) / B^2_P(\SL_2(\ZZ), E) \cong B^2(\SL_2(\ZZ), E) / B^2_P(\SL_2(\ZZ), E).
\]
Given a cocycle $\tau \in Z^2(\SL_2(\ZZ), E)$, to compute $\omega([\tau]) \in E$ we thus write $\tau = d\kappa$ for some $\kappa \in C^1(\SL_2(\ZZ), E)$ and set
\[
\omega([\tau]) = \kappa\left( \begin{pmatrix} 1 & 1 \\ 0 & 1 \end{pmatrix}\right).
\]
It remains to explain how to write $\tau = d\kappa$ as a coboundary.

The key fact used in computing $\kappa$ is that $\SL_2(\ZZ)$ is generated by torsion elements
\begin{align*}
R &= \begin{pmatrix} 0 & -1 \\ 1 & -1 \end{pmatrix}, \\
S &= \begin{pmatrix} 0 & -1 \\ 1 & 0 \end{pmatrix};
\end{align*}
note that $R$ has order $3$ and $S^2 = -I$.  We can determine $\kappa(R)$ and $\kappa(S)$ as follows, using the construction of $\kappa$ as $d\kappa = \tau$.
\begin{align*}
\tau(S,S) &= 2\kappa(S) - \kappa(-I) \\
\tau(-I,-I) &= 2\kappa(-I) - \kappa(I) \\
\tau(I,I) &= \kappa(I).
\end{align*}
Moreover, since $\tau$ is defined as a cup product of $\sigma_\Phi$ and $\sigma_\Psi$, which vanish on $\pm I$, we have that $\tau(\pm I, A) = \tau(A, \pm I) = 0$ for any $A \in \SL_2(\ZZ)$.  Thus
\begin{equation}
\kappa(S) = \frac12 \tau(S,S).
\end{equation}
Similarly,
\begin{align*}
\tau(R,R) &= 2\kappa(R) - \kappa(R^2) \\
\tau(R,R^2) &= \kappa(R) + \kappa(R^2),
\end{align*}
and solving this linear system gives
\begin{equation}
\kappa(R) = \frac13 \tau(R,R) + \frac13 \tau(R,R^2).
\end{equation}
Now, an arbitrary element of $\SL_2(\ZZ)$ can be decomposed as a word in $R$ and $S$ using the Euclidean algorithm, say $A = \prod_{i=1}^m x_i$, where each $x_i$ is ether $R$ or $S$.  We use the equations
\begin{align*}
\tau(x_1, \prod_{i=2}^m x_i) &= \kappa(x_1) + \kappa(\prod_{i=2}^m x_i) - \kappa(A) \\
&\hspace{5pt}\vdots \\
\tau(x_{m-1}, x_m) &= \kappa(x_{m-1}) + \kappa(x_m) - \kappa(x_{m-1}x_m)
\end{align*}
to solve for $\kappa(A)$ in terms of $\kappa(R)$, $\kappa(S)$ and values of $\tau$.

\section{Application to Adjoint $L$-functions} \label{sec:adjoint}

\end{document}