\documentclass[10pt]{amsart}

\title{Computing Adjoint $L$-functions}
\author{David Roe}
\address{Department of Mathematics, University of Pittsburgh, 301 Thackeray Hall, Pittsburgh, PA , United States, 15260.}
\email{roed.math@gmail.com}
\author{Ander Steele}
\address{Department of Mathematics, University of California Santa Cruz, 1156 High Street, Santa Cruz, CA, United States, 95060}
\email{gasteele@ucsc.edu}

%\subjclass[2010]{}
%\keywords{}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsrefs}
% Fonts
\usepackage{mathrsfs}
% Enumitem
\usepackage{enumitem}
% Hyperrefs
\usepackage{hyperref}

\usepackage{tikz}
\usetikzlibrary{shapes,arrows,calc,matrix}
\usepackage{tikz-cd}

%%%%% for spacing
\usepackage{lipsum}
\usepackage{setspace}

%%%%%%%%%%%%%%% THEOREM STYLES %%%%%%%%%%%%%%%
\theoremstyle{plain}
      \newtheorem{theorem}{Theorem}[section]
      \newtheorem*{theorem*}{Theorem}
      \newtheorem{proposition}[theorem]{Proposition}
      \newtheorem{lemma}[theorem]{Lemma}
      \newtheorem{corollary}[theorem]{Corollary}

      \theoremstyle{definition}
      \newtheorem{definition}[theorem]{Definition}

      %\theoremstyle{remark}
      \newtheorem{remark}[theorem]{Remark}
      \newtheorem{example}[theorem]{Example}
      
      \newtheorem{conjecture}[theorem]{Conjecture}
%%%%%%%%%%%%%%% RINGS AND GROUPS %%%%%%%%%%%%%%%
\newcommand{\ZZ}{{\mathbb{Z}}}
\newcommand{\NN}{{\mathbb{N}}}
\newcommand{\CC}{{\mathbb{C}}}
\newcommand{\QQ}{{\mathbb{Q}}}
\newcommand{\RR}{{\mathbb{R}}}
\newcommand{\OK}{\mathcal{O}_K}
\newcommand{\cH}{\mathcal{H}}
\newcommand{\cA}{\mathcal{A}}
\newcommand{\cD}{\mathcal{D}}

\newcommand{\cW}{\mathcal{W}}
\newcommand{\G}{\mathbb{G}}


%%%%%%%%%%%%%%% NAMED OPERATORS %%%%%%%%%%%%%%%
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\ord}{ord}

\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\PGL}{PGL}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\Symb}{Symb}
\DeclareMathOperator{\BSymb}{BSymb}
\DeclareMathOperator{\Hh}{H}
\DeclareMathOperator{\cor}{cor}
\DeclareMathOperator{\ad}{ad}
\DeclareMathOperator{\Sp}{Sp}




%%%%%%%%%%%% BEGIN DOCUMENT %%%%%%%%%%%
\usepackage{todonotes}

\begin{document}
\maketitle

\section{Introduction}

\section{Review}

Let $E$ be a complete, discrete valued field.  \todo{think about what works in characteristic $p$}

\section{Cohomology of Modular Curves} \label{sec:mod_curve_cohom}
% Reference appendix to Hida's Elementary Theory of L-functions and Eisenstein Series
%The theory of modular symbols allows us to efficiently compute with spaces of modular forms. We briefly recall 

Let $\Gamma$ be a congruence subgroup with $\Gamma_1(N) \subseteq \Gamma \subseteq \Gamma_0(N)$. Denote by $\Delta_0$ the degree-$0$ divisors on $\mathbb{P}^1(\QQ)$, equipped with the left action of $\Gamma$ by fractional linear transformations. Let $M$ be any right $\ZZ[\Gamma]$-module. The space of $M$-valued modular symbols for $\Gamma$ is defined as

\begin{equation}
	\Symb_\Gamma(M) := \Hom_{\ZZ[\Gamma]}(\Delta_0, M).
\end{equation}

\begin{proposition}[Ash-Stevens]
Suppose $\Gamma$ acts invertibly on $\cH$, or $6$ acts invertibly on $M$. Then $H^1_c(\Gamma,M)$ is [canonically and functorially?] isomorphic to $\Symb_\Gamma(M)$.
%and we have an exact sequence:
%\begin{equation*}
%\BSymb_\Gamma(M)\longrightarrow \Symb_\Gamma(M)\longrightarrow H^1_p(\Gamma, M)\longrightarrow 0
%\end{equation*}
\end{proposition}
%the the compactly supported cohomology of the open modular curve $\Gamma\cH$, with coefficients in the local system blah blah blah.


We have a natural map $H^1_c(\Gamma, M)\longrightarrow H^1(\Gamma,M)$, and thus a natural map from $\Symb_\Gamma(M)\longrightarrow H^1(\Gamma,M)$. Concretely, a modular symbol $\Phi\in \Symb_\Gamma(M)$ is mapped to the cohomology class of the inhomogeneous cocycle $\sigma_\Phi$ defined by
\begin{align}
\sigma_{\Phi}(\alpha, \beta) &= \Phi(\{\alpha \cdot \infty, \beta \cdot \infty\}).% \\
%\sigma_{\Psi}(\alpha, \beta) &= \Psi(\{\alpha \cdot \infty, \beta \cdot \infty\}).
\end{align}
\begin{definition}
The parabolic cohomology $H^1_p(\Gamma,M)$ is defined to be the image of the natural map $H^1_c(\Gamma,M)\longrightarrow H^1(\Gamma,M)$.
\end{definition}
The kernel of the map $\Symb_\Gamma(M)\longrightarrow H^1_p(\Gamma,M)$ is the subspace of boundary symbols, which correspond to Eisenstein series. See [Bellaiche reference on Eichler-Shimura]



\subsection{Classical Modular Symbols}
\begin{definition}
Let $F$ be a field and $k\geq 0$ be an integer. Define $V_k(F):=\Sym^k(F^2)$. We identify $V_k(F)$ with homogeneous degree-$k$ polynomials in two variables, $V_k(F) = F[X,Y]_k$. We equip $V_k(F)$ with a right-action of $\GL_2(F)$ by $P(X,Y)|\gamma =\det(\gamma)^{k}P((X,Y)|\gamma^{-1})=P(dX-cY,-bX+aY)$, where $\gamma=\begin{pmatrix} a & b \\ c & d\end{pmatrix}$. 
\end{definition}
The connection with modular forms is described by the Eichler-Shimura Isomorphism. A cuspidal modular form $f\in S_{k+2}(\Gamma)$ gives rise to a modular symbol $\phi_{f}\in \Symb_{\Gamma} (V_k(\CC))$ by
\begin{equation*}
	\phi_{f} \{r, s\} = \int_r^s f(z) (zX+Y)^k dz.
\end{equation*}
Let $\iota = \begin{pmatrix} -1 & 0 \\ 0 & 1\end{pmatrix}$, which normalizes $\Gamma$ and hence induces an involution on $H^1_p(\Gamma, V_k(\CC))$ [insert reference] (this involution roughly corresponds to the action of complex conjugation). Thus, $H^1_p(\Gamma, V_k(\CC))$ decomposes into $H^1_p(\Gamma,V_k(\CC))^+\oplus H^1_p(\Gamma,V_k(\CC))^-$, and $\phi_f = \phi_f^+ + \phi_f^-$. 

For each cusp form $f\in S_{k+2}(\Gamma)$, let $F$ be a number field containing the coefficients of the normalized $q$-expansion of $f$. Then a theorem of Shimura [need ref!] gives complex periods $\Omega_f^\pm$ such that $\phi_f^\pm/\Omega_f^\pm \in \Symb_\Gamma(V_k(\overline{F}))$. \todo{Explain notation $S_{k+2}(\Gamma, F)$ in this paragraph}
%see 3.4 of Pollack-Stevens
\begin{theorem}[Eichler-Shimura]
Let $F$ be a number field. The maps $S_{k+2}(\Gamma,F)\longrightarrow H^1_p(\Gamma, V_k(F))^\pm$, $f\mapsto \phi_{f}^\pm$ are isomorphisms of Hecke modules. That is,
\begin{equation*}
	H^1_p(\Gamma, V_k(F)) \cong S_{k+2}(\Gamma,F)\oplus \overline{S_{k+2}(\Gamma,F)}
\end{equation*}
\end{theorem}

\subsection{Overconvergent Modular Symbols}
By replacing the vector spaces $V_k(F)$ with spaces of $p$-adic distributions $\cD_k(F)$, Stevens \cite{Stevens} constructs \emph{overconvergent} modular symbols corresponding to  overconvergent modular forms.

We closely follow \cite{Bellaiche}, referring the reader there for details. Let $L$ be a commutative, noetherian $\QQ_p$-Banach algebra with norm $|\cdot |$. \footnote{ The notation that Bella\"iche uses differs from that of Stevens, Pollack-Stevens, and Harron-Pollack.} \todo{Decide on which notation to adopt! Make list of differences}

For each $r\in p^\QQ$, denote by $\cA[r](L)$ the $L$-module of functions $f:\ZZ_p\rightarrow L$ which, for all $e\in\ZZ_p$,  have power series expansions 
\begin{equation*}
	f(z) = \sum_{n \geq 0 } a_n(e) (z-e)^n
\end{equation*}
converging on the closed balls $B[e,r] = \{z \in \CC_p, |z-e| \leq r\}$. The space $\cA[r](L)$ is a $\QQ_p$-Banach algebra under the norm $||f ||_r = \sup_{e\in\ZZ_p} \sup_n |a_n(e)|r^n$. When $L=\QQ_p$, we simply write $\cA[r]:=\cA[r](\QQ_p)$.



\begin{definition}
Let $\cD[r](\QQ_p)$ denote the Banach-dual
\begin{equation}
	\cD[r](\QQ_p) = \Hom_{\QQ_p}(\cA[r],\QQ_p).
\end{equation}
It is naturally a $\QQ_p$-Banach module under the norm $||\mu||_r := \sup_{f\in \cA[r]} \frac{ |\mu(f)|}{||f||_r}$. We define $\cD[r](L) :=\cD[r](\QQ_p) \widehat{\otimes} L$.
\end{definition}

\begin{remark}
We note that the notation we have adopted differs from the notation in \cite{HarronPollack}, which defines the above modules as $\Hom_{\QQ_p}(\cA[r],L)$. Both modules are considered in both papers, but this latter module is in fact much larger than the spaces we work with, and apparently does not satisfy desired base-change properties. We note that there is an injection $\cD[r](L)\hookrightarrow \Hom_{\QQ_p} (\cA[r], L)$.
\end{remark}

\begin{proposition}[\cite{Bellaiche}, III.4.18 and III.4.21] For $r_1> r_2$, the natural restriction maps $\cA[r_1](L)\rightarrow \cA[r_2](L)$  and $\cD[r_2](L)\rightarrow \cD[r_1](L)$ are injective and compact.
\end{proposition}

\begin{definition}
For any $r\geq 0$, the spaces of \emph{overconvergent} functions and distributions are defined as
\begin{align}
	\cA^\dagger[r](L) &:= \varinjlim_{s>r} \cA[s](L)\\
	\cD^\dagger[r](L) &:=\varprojlim_{s>r} \cD[s](L).
\end{align}
When $r=0$ and $L=\QQ_p$, we simply write $\cA^\dagger = \cA^\dagger[0](\QQ_p)$, $\cD^\dagger = \cD^\dagger[0](\QQ_p)$.
[Question: r=0 or r=1?]
\end{definition}
We will focus primarily on the cases where $L$ is a finite extension of $\QQ_p$, or where $L$ is an open affinoid of weight-space.

\subsection{Weight $\kappa$ action}
Let $\Sigma_0(p)$ denote the monoid
\begin{equation*}
	\Sigma_0(p) : = \left\{ \begin{pmatrix} a & b \\ c & d\end{pmatrix}\in M_2(\ZZ_p) : a\in \ZZ_p^\times, c\in p\ZZ_p\right\}.
\end{equation*}

\begin{definition}
For each integer $k\geq 0$, we define a (left) weight-$k$ action of $\Sigma_0(p)$ on $\cA^\dagger$ by 
\begin{equation}
	\gamma \cdot_k f(z) := (a+cz)^k f\left(\frac{b+dz}{a+cz}\right).
\end{equation}
[rem: Bellaiche seems to replace z by -z in the RHS. should track this down later.]
This induces a right action on $\cD^\dagger$ by $(\mu|_k\gamma) (f) = \mu(\gamma\cdot_k f)$. We denote by $\cA_k^\dagger$, $\cD_k^\dagger$ the underlying spaces equipped with this weight-$k$ action.
\end{definition}

\begin{remark}
We have a $\Sigma_0(p)$-equivariant surjection $\rho_k : \cD_k^\dagger\rightarrow V_k(\QQ_p)$, called the specialization map, defined by $\rho_k(\mu) = \mu( zX-Y)^k$, which induces a Hecke-equivariant homomorphism $\rho_k : H_c^1(\Gamma, \cD^\dagger_k)\rightarrow H^1_c (\Gamma, V_k(\QQ_p))$. Stevens shows \cite{Stevens} that this homomorphism is in fact an isomorphism for small slope ($<k$) modular symbols. 
\end{remark}

Denote by $\cW:=\Hom_{cts}(\ZZ_p^\times,\G_m)$ the space of $p$-adic weights. For example, each integer $k\in\ZZ$ can be viewed as the $\QQ_p$-valued $p$-adic weight $z\mapsto z^k$. As before, let $E$ be a finite extension of $\QQ_p$. For each $\kappa\in \cW(E) =\Hom_{cts}(\ZZ_p^\times,E^\times)$, one defines the weight-$\kappa$ action of $\Sigma_0(p)$ on $\cA^\dagger(E)$ by
\begin{equation*}
	\gamma \cdot_\kappa f(z) = \kappa(a+cz) f\left(\frac{b+dz}{a+cz}\right).
\end{equation*}
When $\kappa$ is an integer weight $z\mapsto z^k$, we recover the weight-$k$ action above.
\begin{remark}
In order to interpret the automorphy factor, we use the fact that the the function $z\mapsto \kappa(a+cz)$ is a locally analytic function on $\ZZ_p$--see \S III.6.1 of \cite{Bellaiche} or \S2.3 of \cite{Robs} for details.
\end{remark}
The left-action of $\Sigma_0(p)$ on $\cA^\dagger$ induces a right action on $\cD^\dagger(E)$ by
\begin{equation*}
	\mu|_\kappa \gamma = f\mapsto \mu( \gamma\cdot_\kappa f).
\end{equation*}
%For any $\kappa\in \cW(\C_p)$, the space of weight-$\kappa$ overconvergent modular symbols is defined as
%\begin{equation*}
%	H^1_c(\Gamma)
%\end{equation*}
\begin{remark}
For general $p$-adic weights, the work of \cite{Andreatta, Iovita, Stevens} gives an Eichler-Shimura isomorphism comparing overconvergent modular symbols with overconvergent modular forms
\end{remark}

\subsection{Families of Modular Symbols}
For any admissible affinoid $W=\Sp(R)$ of $\cW$, consider the space $\cD^\dagger(R)$. The inclusion $W\subset \cW$ is a point of $\cW(R)$, and thus we have a homomorphism $K\in \cW(R)=\Hom_{cts}(\ZZ_p^\times,R^\times)$. This character allows us to define an action of $\Sigma_0(p)$ on $\cA^\dagger(R)$ and $\cD^\dagger(R)$ by
\begin{equation}
	\gamma \cdot_K f(z) = K(a+cz) f(z), ~~ (\mu|_K\gamma)= f\mapsto \mu(\gamma\cdot_K f).
\end{equation}
If $w\in W(E)=\Hom_{cts}(R,E^\times)$ is a point in $W$, then the composition $w\circ K : \ZZ_p^\times\rightarrow R^\times\rightarrow E^\times$ is a character $\kappa\in \Hom_{cts}(\ZZ_p^\times,E^\times)$. The compatibility of $\cD^\dagger(R)$ with base change shows
\begin{lemma}[IV.1.1 of \cite{Bellaiche}]
If $E/\QQ_p$ is any finite extension of $\QQ_p$ and $w\in W(E)$ is an $E$-point of $W$, then there is a natural isomorphism
\begin{equation*}
	\cD^\dagger(R)\otimes_{R,w} E \cong \cD_\kappa^\dagger(E)
\end{equation*}
where $\kappa = w\circ K$.
\end{lemma}
In other words, we may view $\cD^\dagger(R)$ as the space of families of distributions over $W$, specializing at each weight $\kappa$ in $W$ to $\cD_\kappa^\dagger$.

As a concrete example, we follow \S2.4 of \cite{Robs}. Let $\omega:\ZZ_p^\times\rightarrow\QQ_p^\times$ denote the Teichmuller character. Since $\ZZ_p^\times\cong (\ZZ/p)^\times\times(1+p\ZZ_p)$, a a character $\kappa \in \cW(\QQ_p)=\Hom_{cts}(\ZZ_p^\times,\QQ_p^\times)$ is uniquely determined by its restriction to $(\ZZ/p)^\times$ and its value on a topological generator $\gamma$ of $1+p\ZZ_p$. The characters of $(\ZZ/p)^\times$ are precisely the $p-1$ powers of the Teichmuller character, and thus $\cW(\QQ_p)$ can be identifed with $p-1$ copies of $\Hom_{cts}(1+p\ZZ_p,\QQ_p^\times)$. For each integer $m$ modulo $p-1$, write $\cW_m\subset\cW(\QQ_p)$ for the subset of characters $\kappa$ whose restriction to $(\ZZ/p)^\times$ is $\omega^m$.  Fixing the topological generator $\gamma=1+p$ of $1+p\ZZ_p$, we can identify $\cW_m$ with the $p$-adic ball $B(0,1)$ by $\kappa \mapsto \kappa(\gamma)-1$. The space of analytic functions on these open balls is precisely the Tate algebra $R=\QQ_p\langle \langle w \rangle\rangle$. Thus $\cW_m \cong \Sp(R)$. 

The character $K\in\Hom_{cts}(\ZZ_p^\times,R^\times)$ is characterized by
\begin{align*}
	K(a+cZ)  &= \omega^m(a) (1+px)^{\log_\gamma\frac{a+cz}{\omega(a)}},
\end{align*}
where the right-hand-side is considered as an element of $\cA^\dagger(R)$--see equations $2.1$ and $2.2$ of \cite{Robs} for details. Picking an integer $k\in\ZZ$ such that $k\equiv m\pmod{p-1}$, we have the $\QQ_p$-valued point $w\in \cW_m(\QQ_p)$ given by $x\mapsto \left(\frac{(1+p)^k-1}{p}\right)$, and one can check that $w\circ K (a+cZ) = (a+cz)^k$.



\section{Pairings on Coefficient Modules} \label{sec:coeff_pairing}

We have assumed given a $\Gamma$-equivariant pairing $\langle~,~ \rangle : M \times M \longrightarrow E$ (or another trivial $\Gamma$ representation). We explicitly write down the pairing in our cases of interest and check that the necessary equivariance is satisfied. 

\subsection{$V_k(E)$}

As before, we identify $V_k(E)$ with $E[X,Y]_k$, and endow it with left action of $\GL_2(\QQ)$ by $\gamma \cdot P(X,Y) = P((X,Y)\gamma)=P(aX+cY,bX+dY).$ 
\begin{definition}
Define a bilinear pairing on $V_k(E)$ by
\begin{equation*}
	\langle X^iY^{k-i}, X^j Y^{k-j} \rangle = \begin{cases} (-1)^i {k \choose i} & \text{ if } i+j=k\\
												0	& \text{ otherwise} \end{cases}
\end{equation*}
and extending via linearity.
\end{definition}


\begin{lemma}
For all $\gamma\in \GL_2(\QQ)$, $P,Q\in V_k(E)$, we have $\langle \gamma\cdot P,\gamma \cdot Q\rangle = \det(\gamma)^k \langle P,Q\rangle$.
\end{lemma}
\begin{proof}
This can be seen via an ugly computation. (There should be an easy way to see this in terms of the wedge product).
\end{proof}

For the purposes of Hecke-equivariance, we define a twisted pairing using the Atkin-Lehner involution $W_N = \begin{pmatrix} 0 & -1 \\ N & 0 \end{pmatrix}$.
\begin{definition}
The twisted pairing on $V_k(E)$ is defined by
\begin{equation}
	\langle P, Q\rangle^t := \langle P, W_N \cdot Q\rangle.
\end{equation}
\end{definition}
More explicitly,
\begin{equation*}
	\langle X^iY^{k-i}, X^j Y^{k-j} \rangle_N^t = \langle X^i Y^{k-i}, (-Y)^j(NX)^{k-j}\rangle= \begin{cases} (-1)^k N^i {k \choose i} & \text{ if } i=j\\
												0	& \text{ otherwise} \end{cases}
\end{equation*}

The space $V_k(\QQ_p)$ is a quotient of $\cD_k(\QQ_p)$ via the specialization map $\rho_k: \cD_k\rightarrow V_k(\QQ_p)$. It can be shown that the pairings from the previous section extend in a $\Sigma_0(p)$-equivariant way to $\cD_k$. %Moreover, the twisted pairing behaves well with respect to our finite approximations. [Insert details]

\begin{definition}
Let $\langle~,~\rangle^t_N : \cD_k\times\cD_k\longrightarrow \QQ_p$ be the $\QQ_p$-bilinear pairing
\begin{equation}
	\langle \mu, \nu \rangle_N^t := \sum_{n=0}^\infty {k \choose n} (Np)^n \mu(z^n)\nu(z^n)
\end{equation}
\end{definition}




\begin{definition}
Let $\langle ~, ~\rangle^t_N :\cD(\Lambda)\times\cD(\Lambda) \longrightarrow \Lambda$ be the $\Lambda$-bilinear pairing
\begin{equation}
	\langle \mu, \nu \rangle_N^t = \sum_{n=0}^\infty {\frac{\log_p(1+pw)}{\log_p(1+p)} \choose n} (Np)^n \mu(z^n)\nu(z^n).
\end{equation}
\end{definition}

\begin{lemma}
The above pairing interpolates the weight-$k$ twisted pairings, and satisfies the following equivariance property: for all $\gamma \in\Gamma_0(p)$, $\mu,\nu\in \cD(\Lambda)$, 
\begin{equation}
	\langle \mu | \gamma, \nu\rangle_N^t  = \langle \mu, \nu| W_{Np}^{-1}\gamma^* W_{Np}\rangle_N^t.
\end{equation}	
\end{lemma}


\section{Existing Pairings on Modular Symbols} \label{sec:existing_pairings}
% Reference discussions of pairings in Bellaiche and Kim's thesis
% Relate to Petersson inner product
The Petersson inner product is a natural Hermitian inner product on $S_{k+2}(\Gamma,\CC)$ defined by:
\begin{equation*}
	(f,g) := \int_{\cH/\Gamma} f(z) \overline{g(z)} y^{k} dx dy
\end{equation*}

[Here we introduce the Rankin product and adjoint $L$-function, and state the relationship between these and Petersson inner product. Roughly $(f,f)=L(\ad f,k+1)$]

The pairing on $V_k$ [where to put this] and the cup product induce a pairing on $H^1_c(V_k)$:
\begin{equation*}
	H^1_c(V_k)\times H^1_c(V_k) \longrightarrow H^2_c(V_k\otimes V_k)\longrightarrow H^2_c(\CC)\cong \CC
\end{equation*}
Moreover, this cup product pairing is compatible with the Petersson inner product.
\begin{proposition}[III.2.6 of Bella\"iche]
\begin{equation*}
	(\phi_f,\phi_g ) = (2i)^{k-1}[(f,g) + (-1)^{k+1} (g,f)]
\end{equation*}
\end{proposition}


[Bella\"iche, section III.2.7]
Hecke operators: Suppose now that $\Gamma_1(N)\subseteq \Gamma \subseteq \Gamma_0(N)$. Let 
\begin{equation}
	W_N = \begin{pmatrix} 0 & -1 \\ N & 0\end{pmatrix}
\end{equation}
which normalizes $\Gamma_0(N)$ and (after some work) $\Gamma$. See Lemma III.2.4.

The ``corrected" scalar product:
\begin{equation*}
	[f,g] : =(f,g|W)
\end{equation*}

\begin{lemma}[III.2.26]
The Hecke operators $T_\ell$ ($\ell\nmid N$, $U_q$ , and $\langle a \rangle$ are self-adjoint with respect to the corrected scalar product:
\begin{equation*}
	[f|T,g]=[f,g|T].
\end{equation*}	
\end{lemma}

[Add discussion of cup products]


\section{Cup products, parabolic cohomology, and corestriction}

We gave a geometric description of the cup product pairing
\begin{equation} \label{eq:pcoh_pairing}
H^1_p(\Gamma, M) \times H^1_p(\Gamma, M) \to E
\end{equation}
in Section \ref{sec:existing_pairings}.  We begin this section by giving an alternative description in terms of group cohomology.

Given homogeneous cochains $\sigma_1, \sigma_2 \in Z^1_p(\Gamma, M)$, their cup product is given by
\[
(\sigma_1 \cup \sigma_2)(g_0, g_1, g_2) = \langle \sigma_1(g_0, g_1), \sigma_2(g_1, g_2) \rangle
\]
(see \cite{Sharifi}*{Rem. 1.9.3} for example). To define the pairing \eqref{eq:pcoh_pairing}, we need to compose with a homomorphism $\omega_\Gamma : H^2_p(\Gamma, E) \to E$.  This map is defined using the following lemma.

\begin{lemma} \label{lem:H2E}
The cohomology group $H^2(\Gamma, E)$ vanishes.
\end{lemma}
\begin{proof}

<<<<<<< HEAD
\section{Reducing to Level 1} \label{sec:level_one}
[Rem: Hida's Elementary Theory of Eisenstein series, Appendix, Proposition 2, gives an isomorphism between $H^2_c(\Gamma, M)$ and $H^2_P(\Gamma, M)$.]
=======
\end{proof}
>>>>>>> af8c5ede97ef24afb72ad8785ab8d3b739a52081

By Lemma \ref{lem:H2E}, if $\tau \in Z^2(\Gamma, E)$ then there is some cochain $\kappa \in C^1(\Gamma, E)$ so that $\tau = d\kappa$.  We set
\[
\omega_\Gamma(\tau) = \sum_{g \in \SL_2(\ZZ) / \Gamma} \kappa\left(g, g \cdot \left(\begin{smallmatrix} 1 & 1 \\ 0 & 1 \end{smallmatrix}\right)\right).
\]
Note that the definition of $\omega_\Gamma$ does not depend on the choice of coset representatives, since $\kappa(hg_0, hg_1) = \kappa(g_0, g_1)$ for $h \in \Gamma$.  We write $\omega$ for $\omega_{\SL_2(\ZZ)}$.  

\begin{definition}
The pairing $\langle , \rangle : H^1_p(\Gamma, M) \times H^1_p(\Gamma, M) \to E$ is defined by
\[
\langle [\sigma_1], [\sigma_2] \rangle =
\]
\end{definition}
Compatibility with the pairing defined in Section \ref{sec:existing_pairings} follows from the following result.

\begin{proposition}
The diagram
\[
\begin{tikzcd}
H^2_c(\Gamma, E) \arrow{r} \arrow{d} & E \arrow[equal]{d} \\
H^2_p(\Gamma, E) \arrow{r}{\omega_\Gamma} & E
\end{tikzcd}
\]
commutes, where the left map is the natural surjection and the top map is Poincar\'e duality.  Moreover, all of the maps are isomorphisms.
\end{proposition}
\begin{proof}

\end{proof}

\begin{corollary}

\end{corollary}

We now describe how to use corestriction to reduce the computation of the cup product pairing
on $\Gamma$ to the analogous pairing on $\SL_2(\ZZ)$.  We first need to describe the corestriction
map on parabolic cohomology.

In terms of cochains, the corestriction map
\[
\cor : C^i(\Gamma, E) \to C^i(\SL_2(\ZZ), E)
\]
is the composition of the isomorphism
\[
C^i(\Gamma, E) \to C^i(\SL_2(\ZZ), \Hom_{\ZZ[\Gamma]}(\ZZ[\SL_2(\ZZ)], E))
\]
from Shapiro's lemma \cite{Sharifi}*{Thm. 1.5.3} with the trace map
\begin{align*}
\Hom_{\ZZ[\Gamma]}(\ZZ[\SL_2(\ZZ)], E) &\to E \\
\varphi &\mapsto \sum_{g \in \SL_2(\ZZ)/\Gamma} \varphi(g).
\end{align*}
Since $\cor$ commutes with the differential, we obtain induced maps
\begin{align*}
\cor : H^i(\Gamma, E) &\to H^i(\SL_2(\ZZ), E) \\
\cor : H^i_p(\Gamma, E) &\to H^i_p(\SL_2(\ZZ), E).
\end{align*}

\begin{proposition}
The diagram
\[
\begin{tikzcd}
H^2_p(\Gamma, E) \ar{r}{\omega_\Gamma} \ar[swap]{d}{\cor} & E \ar[equal]{d} \\
H^2_p(\SL_2(\ZZ), E) \ar{r}{\omega} & E
\end{tikzcd}
\]
commutes.
%\[
%\begin{tikzcd}
%H^1_p(\Gamma, M) \times H^1_p(\Gamma, M) \ar{r} \ar[xshift=6ex]{d}{\cor} \ar[xshift=-6ex,swap]{d}{\cor} & H^2_p(\Gamma, E) \ar{d}{\cor} \\
%H^1_p(\SL_2(\ZZ), M) \times H^1_p(\SL_2(\ZZ), M) \ar{r} & H^2_p(\SL_2(\ZZ), E)
%\end{tikzcd}
%\]=
\end{proposition}
\begin{proof}

\end{proof}

\section{Using torsion in \texorpdfstring{$\SL_2(\ZZ)$}{SL(2,Z)}} \label{sec:using_torsion}

In this section we describe how to write a cocycle $\tau \in Z^2(\SL_2(\ZZ), E)$ as a coboundary $\tau = d\kappa$.
The key fact used in computing $\kappa$ is that $\SL_2(\ZZ)$ is generated by torsion elements
\begin{align*}
R &= \begin{pmatrix} 0 & -1 \\ 1 & -1 \end{pmatrix}, \\
S &= \begin{pmatrix} 0 & -1 \\ 1 & 0 \end{pmatrix};
\end{align*}
note that $R$ has order $3$ and $S^2 = -I$.

We can determine $\kappa(R)$ and $\kappa(S)$ as follows, using the construction of $\kappa$ as $d\kappa = \tau$.
\begin{align*}
\tau(S,S) &= 2\kappa(S) - \kappa(-I) \\
\tau(-I,-I) &= 2\kappa(-I) - \kappa(I) \\
\tau(I,I) &= \kappa(I).
\end{align*}
Moreover, since $\tau$ is defined as a cup product of $\sigma_\Phi$ and $\sigma_\Psi$, which vanish on $\pm I$, we have that $\tau(\pm I, A) = \tau(A, \pm I) = 0$ for any $A \in \SL_2(\ZZ)$.  Thus
\begin{equation}
\kappa(S) = \frac12 \tau(S,S).
\end{equation}
Similarly,
\begin{align*}
\tau(R,R) &= 2\kappa(R) - \kappa(R^2) \\
\tau(R,R^2) &= \kappa(R) + \kappa(R^2),
\end{align*}
and solving this linear system gives
\begin{equation}
\kappa(R) = \frac13 \tau(R,R) + \frac13 \tau(R,R^2).
\end{equation}
Now, an arbitrary element of $\SL_2(\ZZ)$ can be decomposed as a word in $R$ and $S$ using the Euclidean algorithm, say $A = \prod_{i=1}^m x_i$, where each $x_i$ is ether $R$ or $S$.  We use the equations
\begin{align*}
\tau(x_1, \prod_{i=2}^m x_i) &= \kappa(x_1) + \kappa(\prod_{i=2}^m x_i) - \kappa(A) \\
&\hspace{5pt}\vdots \\
\tau(x_{m-1}, x_m) &= \kappa(x_{m-1}) + \kappa(x_m) - \kappa(x_{m-1}x_m)
\end{align*}
to solve for $\kappa(A)$ in terms of $\kappa(R)$, $\kappa(S)$ and values of $\tau$.

\section{Application to Adjoint $L$-functions} \label{sec:adjoint}

[Here we follow Kim's thesis and Bella\"iche's book. Maybe Hida in the ordinary case?]

The main theorem will look like
\begin{theorem}[Prototype]
\begin{equation}
	L^{alg}(\ad f , k-1) = [\Phi_{f}^+,\Phi_{f}^-]
\end{equation}
\end{theorem}
One problem is that $L^{lag}$ is not well-defined---it depends on a choice of complex periods. See Kim, Theorem 3.9.3 for a precise (if suspect!) statement. Note that this only handles the case that $f$ has level $Np^r$ for $r\geq 1$ and non-trivial nebentype. Will need Hida for a reference in the ordinary case, since Bella\"iche is incomplete.

Note: Kim's results seem to require a Gorenstein property of the Hecke algebra. Bella\'iche's construction of $L^{adj}$ is slightly different: $L^{adj}$ is defined as a generator of a canonical ideal $\mathcal{L}^{adj}$ whenever that ideal is principal. A precise relation to Kim's definition (and ours) is given by Bella\"iche Proposition VI.4.5.

\begin{definition}
A closed point $x\in C^o$ with field of definition $L$ is a \emph{good point} if [Insert long definition here?]
Bella\ $\Symb_\Gamma(\cD(L))^\pm[x]$ are $1$-dimensional.
\end{definition}

\begin{proposition}
Let $L$ be a finite extension of $\QQ_p$ and let $x\in \mathcal{C}^o(L)$ be a good point [see REF]. Fix $U=\Sp\mathcal{T}$ a sufficiently small clean neighborhood of $x$ [see REF]. Then for every sufficiently small real $r>0$ there exist two real constants $0<c<C$ such that for every point $y\in U$ with $\kappa(y)=w$ one has
\begin{equation}
	c| [\Phi_{y}^+, \Phi_y^-]_w | \leq |L^{adj}(y) | \leq C | [\Phi_y^+, \Phi_y^-]_w|,
\end{equation}
where $\Phi_{y}^\pm$ are generators of the spaces $H^1_p(\Gamma,\cD_w[r](L))^{\pm}[y]$ such that $||\Phi_y^\pm||_r = 1$. Moreover, the adjoint $p$-adic $L$-function is characterized (up to an element of $\mathcal{T}^\times$) by the above property.
\end{proposition}

\begin{corollary}
On a small clean neighborhood of $x$, the zero loci of $L^{alg}$ and $L^{adj}$ coincide.
\end{corollary}

\begin{remark}
The above corollary probably extends to the entire ordinary part of the cuspidal eigencurve. See Hida's book or ``Iwasawa modules of congruences of cusp forms".
\end{remark}

\end{document}
